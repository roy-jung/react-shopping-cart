var J=Object.defineProperty,W=Object.defineProperties;var V=Object.getOwnPropertyDescriptors;var b=Object.getOwnPropertySymbols;var _=Object.prototype.hasOwnProperty,O=Object.prototype.propertyIsEnumerable;var F=(e,t,s)=>t in e?J(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,C=(e,t)=>{for(var s in t||(t={}))_.call(t,s)&&F(e,s,t[s]);if(b)for(var s of b(t))O.call(t,s)&&F(e,s,t[s]);return e},v=(e,t)=>W(e,V(t));var k=(e,t)=>{var s={};for(var c in e)_.call(e,c)&&t.indexOf(c)<0&&(s[c]=e[c]);if(e!=null&&b)for(var c of b(e))t.indexOf(c)<0&&O.call(e,c)&&(s[c]=e[c]);return s};import{c as X,a as Y,u as Z,Q as K,j as r,b as n,N as x,d as y,e as ee,f as te,L as D,r as d,g as I,h as re,i as se,F as P,k as ne,l as ce,m as ae,R as oe,n as ie,o as le,p as ue,q as de,P as me,B as he}from"./vendor.f01a16c8.js";const Ce=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))c(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&c(l)}).observe(document,{childList:!0,subtree:!0});function s(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerpolicy&&(o.referrerPolicy=a.referrerpolicy),a.crossorigin==="use-credentials"?o.credentials="include":a.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function c(a){if(a.ep)return;a.ep=!0;const o=s(a);fetch(a.href,o)}};Ce();const pe={page:null,scroll:0},T=X({name:"scroll",initialState:pe,reducers:{saveLastScroll:(e,{payload:{page:t,scroll:s}})=>{e.page=t,e.scroll=s}}}),{saveLastScroll:fe}=T.actions,Ne=T.reducer,ge=Y({reducer:{lastScrollInfo:Ne}}),ve=Z;var h=(e=>(e.products="products",e.product="product",e.orders="orders",e.order="order",e.cart="cart",e))(h||{});const Be={headers:{"Content-Type":"application/json"}},Ae="https://roy-cart.herokuapp.com",B=new K({defaultOptions:{queries:{refetchOnWindowFocus:!1}}}),p=async({method:e,path:t,body:s,params:c,signal:a})=>{try{let o=`${Ae}${t}`;const l=C({method:e,signal:a},Be);if(c){const m=new URLSearchParams(c);o+="?"+m.toString()}return s&&(l.body=JSON.stringify(s)),await(await fetch(o,l)).json()}catch(o){console.error(o)}},be=()=>r("header",{children:n("nav",{className:"nav flex justify-around",children:[r(x,{className:"flex-center",to:"/",children:r("h1",{className:"nav-title",children:"CLEAN CODE SHOP"})}),n("div",{className:"flex gap-15",children:[r(x,{className:"nav-button",to:"/cart",children:"\uC7A5\uBC14\uAD6C\uB2C8"}),r(x,{className:"nav-button",to:"/ordered",children:"\uC8FC\uBB38\uBAA9\uB85D"}),r(x,{className:"nav-button",to:"/admin",children:"ADMIN"})]})]})}),xe=()=>ee(h.products,({pageParam:e=1,signal:t})=>p({method:"GET",path:"/products",params:{page:e},signal:t}),{getNextPageParam:(e,t)=>e.length===12&&t.length+1}),De=e=>y([h.product,e],()=>p({method:"GET",path:`/products/${e}`})),E=()=>y(h.cart,()=>p({method:"GET",path:"/cart"})),ye=()=>y(h.orders,()=>p({method:"GET",path:"/orders"})),we=e=>y([h.order,e],()=>p({method:"GET",path:`/orders/${e}`})),S=e=>t=>te(e,t),Pe=S(e=>p({method:"POST",path:"/products",body:e})),Ee=S(e=>p({method:"DELETE",path:`/products/${e}`})),Se=S(e=>p({method:"POST",path:"/cart",body:{id:e}})),R=e=>t=>(t==null?void 0:t.reduce((s,c)=>s+e(c),0))||0,L=R(e=>e.price*e.quantity),M=R(e=>e.quantity),Le=e=>{const t={};if(e instanceof Set)for(const s of e)t[s]=s;else for(const[s,c]of e)t[s]=c;return t},N=(e,t="ko-KR")=>e.toLocaleString(t),Fe=(e=0)=>{let t=null;return new Promise(s=>{const c=a=>{t||(t=a),a-t<e?window.requestAnimationFrame(c):s(!0)};window.requestAnimationFrame(c)})},_e=(e,t)=>{let s=0,c=[];const a=()=>{for(;c.length;){const u=c.pop();window.cancelAnimationFrame(u)}},o=(u,i)=>{s=i;const m=window.requestAnimationFrame(l.bind(null,u));c.push(m)},l=(u,i)=>{if(i-s>=t){s=i,e(...u);return}a();const m=window.requestAnimationFrame(l.bind(null,u));c.push(m)};return(...u)=>window.requestAnimationFrame(o.bind(null,u))},A=({description:e,backTo:t,buttonText:s,fetchMoreEl:c})=>n("div",{className:"contents empty-page",children:[n("div",{children:[r("p",{className:"empty-page__description",children:e}),t&&r(D,{to:t,className:"empty-page__back-button",children:s})]}),r("div",{className:"fetch-more",ref:c})]}),Oe=({imageUrl:e,name:t,quantity:s})=>r("div",{className:"order-container",children:n("div",{className:"flex gap-15 mt-10",children:[r("img",{className:"w-144 h-144",src:e,alt:t}),n("div",{className:"flex-col gap-15",children:[r("span",{className:"order-name",children:t}),n("span",{children:["\uC218\uB7C9: ",s]})]})]})}),ke=()=>{const{data:e}=E();if(!e)return r(A,{description:"\uACB0\uC81C\uD560 \uC0C1\uD488\uC774 \uC5C6\uC5B4\uC694.",backTo:"/",buttonText:"\uD648\uC73C\uB85C"});const t=M(e),s=N(L(e));return n("div",{className:"contents flex",children:[n("section",{className:"order-left-section",children:[n("h3",{className:"order-title",children:["\uC8FC\uBB38 \uC0C1\uD488(",t,"\uAC74)"]}),e.map((c,a)=>n(d.exports.Fragment,{children:[r("hr",{className:`divide-line-${a===0?"gray":"thin"} mt-10`}),r(Oe,C({},c))]},a)),r("hr",{className:"divide-line-thin mt-10"})]}),n("section",{className:"order-right-section",children:[r("div",{className:"order-right-section__top",children:r("h3",{className:"order-title",children:"\uACB0\uC81C\uAE08\uC561"})}),r("hr",{className:"divide-line-thin"}),n("div",{className:"order-right-section__bottom",children:[n("div",{className:"flex justify-between p-20 mt-20",children:[r("span",{className:"highlight-text",children:"\uCD1D \uACB0\uC81C\uAE08\uC561"}),n("span",{className:"highlight-text",children:[s,"\uC6D0"]})]}),r("div",{className:"flex-center mt-30 mx-10",children:n("button",{className:"primary-button flex-center",children:[s,"\uC6D0 \uACB0\uC81C\uD558\uAE30"]})})]})]})]})},g=({title:e})=>n("header",{className:"flex-col-center mt-20",children:[r("h2",{className:"order-section__title",children:e}),r("hr",{className:"divide-line mt-20"})]}),Ie=()=>n("section",{className:"page",children:[r(g,{title:"\uC8FC\uBB38/\uACB0\uC81C"}),r(ke,{})]}),Te=({imageUrl:e,name:t,price:s,quantity:c})=>n("div",{className:"order-list-item",children:[n("div",{className:"flex gap-15 mt-10",children:[r("img",{className:"w-144 h-144",src:e,alt:t}),n("div",{className:"flex-col gap-15",children:[r("span",{className:"order-name",children:t}),n("span",{className:"order-info",children:[s,"\uC6D0 / \uC218\uB7C9: ",c,"\uAC1C"]})]})]}),r("button",{className:"primary-button-small flex-center self-start",children:"\uC7A5\uBC14\uAD6C\uB2C8"})]}),j=({id:e,orderDetails:t})=>n("div",{className:"order-list",children:[n("div",{className:"order-list__header",children:[n("span",{children:["\uC8FC\uBB38\uBC88\uD638: ",e]}),r(D,{to:`/ordered/${e}`,children:"\uC0C1\uC138\uBCF4\uAE30 >"})]}),t.map(s=>d.exports.createElement(Te,v(C({},s),{key:s.id})))]},`orderList_${e}`),Re=({details:e})=>{const t=N(L(e));return r("div",{className:"order-detail-container",children:n("div",{className:"w-480",children:[r("span",{className:"order-detail-title",children:"\uACB0\uC81C\uAE08\uC561 \uC815\uBCF4"}),r("hr",{className:"divide-line-thin my-20"}),n("div",{className:"flex justify-between",children:[r("span",{className:"highlight-text",children:"\uCD1D \uACB0\uC81C\uAE08\uC561"}),n("span",{className:"highlight-text",children:[t,"\uC6D0"]})]})]})})},Me=()=>{const{id:e}=I(),{data:t}=we(e);return!t||!e?null:n("section",{className:"page",children:[r(g,{title:"\uC8FC\uBB38\uB0B4\uC5ED\uC0C1\uC138"}),n("div",{className:"contents",children:[r(j,C({},t)),r(Re,{details:t.orderDetails})]})]})},je=()=>{const{data:e}=ye();return e?r("div",{className:"contents",children:e.map(t=>d.exports.createElement(j,v(C({},t),{key:t.id})))}):r(A,{description:"\uACB0\uC81C \uB0B4\uC5ED\uC774 \uC5C6\uC5B4\uC694.",backTo:"/",buttonText:"\uD648\uC73C\uB85C"})},$e=()=>n("section",{className:"page",children:[r(g,{title:"\uC8FC\uBB38 \uBAA9\uB85D"}),r(je,{})]}),qe=({children:e})=>{const[t,s]=d.exports.useState(null);return d.exports.useEffect(()=>{const c=document.getElementById("modalRoot");if(!!c)return s(c),c.classList.add("show"),()=>{c.classList.remove("show")}},[]),t?re.exports.createPortal(e,t):null},w=({item:e,item:{id:t,price:s,name:c,imageUrl:a},showModal:o,hideButton:l=!1})=>{const u=i=>{i.stopPropagation(),o&&o(e)};return n("div",{className:"product-item",children:[r(D,{to:`/products/${t}`,children:r("img",{src:a,alt:c})}),n("div",{className:"flex justify-between p-5",children:[r(D,{to:`/products/${t}`,children:n("div",{className:"product-info",children:[r("span",{className:"product-info__name",children:c}),n("span",{className:"product-info__price",children:[N(s),"\uC6D0"]})]})}),!l&&r("button",{onClick:u,children:r("img",{src:"/assets/svgs/cart.svg",alt:"\uC7A5\uBC14\uAD6C\uB2C8"})})]})]})},Ge=({closeModal:e,item:t})=>{const{mutate:s}=Se(),c=se(),{data:a}=E(),o=()=>{t&&s(t.id,{onSuccess:l=>{B.setQueryData(h.cart,u=>{const i=[...u||[]],m=(i==null?void 0:i.findIndex(f=>f.id===l.id))||-1;return m>-1?(i.splice(m,1,l),i):(i.push(l),i)}),c("/cart")}})};return t?n(qe,{children:[r("div",{className:"modal-dimmed",onClick:e}),n("div",{className:"modal cart-modal",children:[n("div",{children:[r("p",{children:"\uC7A5\uBC14\uAD6C\uB2C8\uC5D0 \uB2F4\uACA0\uC2B5\uB2C8\uAE4C?"}),r(w,{item:t,hideButton:!0})]}),r("button",{onClick:o,children:"\uB2F4\uAE30 \u2192"}),n("div",{className:"recent-cart",children:[r("p",{children:"\uCD5C\uC2E0 \uC7A5\uBC14\uAD6C\uB2C8 \uBAA9\uB85D"}),r("div",{className:"flex",children:a==null?void 0:a.slice(0,3).map(l=>r(w,{item:l,hideButton:!0},l.id))})]})]})]}):(e(),null)},$=()=>{const[e,t]=d.exports.useState(null),s=a=>{t(a)},c=()=>{t(null)};return{modalComponent:e?r(Ge,{item:e,closeModal:c}):null,showModal:s,closeModal:c}},ze=({item:e,item:{name:t,imageUrl:s,price:c}})=>{const{modalComponent:a,showModal:o}=$();return n("div",{className:"contents product-detail-container",children:[n("div",{className:"flex-col-center w-520",children:[r("img",{className:"w-480 h-480 mb-10",src:s,alt:t}),n("div",{className:"product-detail-info",children:[r("span",{className:"product-detail-info__name",children:t}),r("hr",{className:"divide-line-gray my-20"}),n("div",{className:"flex justify-between",children:[r("span",{children:"\uAE08\uC561"}),n("span",{className:"product-detail-info__price",children:[N(c),"\uC6D0"]})]})]}),r("button",{className:"product-detail-button flex-center mt-20",onClick:()=>o(e),children:"\uC7A5\uBC14\uAD6C\uB2C8"})]}),a]})},Qe=()=>{const{id:e}=I(),{data:t,isLoading:s}=De(e);return s?null:t?n("section",{className:"page",children:[r(g,{title:"\uC0C1\uD488 \uC0C1\uC138"}),r(ze,{item:t})]}):r(A,{description:"\uC0AD\uC81C\uB418\uC5C8\uAC70\uB098 \uC5C6\uB294 \uC0C1\uD488\uC785\uB2C8\uB2E4.",backTo:"/",buttonText:"\uD648\uC73C\uB85C"})},Ue=({isLoading:e})=>e?r("div",{className:"loading-indicator",children:n("svg",{version:"1.1",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",children:[r("title",{children:"spinner"}),r("path",{d:"M12 4c0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.209-1.791 4-4 4s-4-1.791-4-4zM20.485 7.515c0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.209-1.791 4-4 4s-4-1.791-4-4zM26 16c0-1.105 0.895-2 2-2s2 0.895 2 2c0 1.105-0.895 2-2 2s-2-0.895-2-2zM22.485 24.485c0-1.105 0.895-2 2-2s2 0.895 2 2c0 1.105-0.895 2-2 2s-2-0.895-2-2zM14 28c0 0 0 0 0 0 0-1.105 0.895-2 2-2s2 0.895 2 2c0 0 0 0 0 0 0 1.105-0.895 2-2 2s-2-0.895-2-2zM5.515 24.485c0 0 0 0 0 0 0-1.105 0.895-2 2-2s2 0.895 2 2c0 0 0 0 0 0 0 1.105-0.895 2-2 2s-2-0.895-2-2zM4.515 7.515c0 0 0 0 0 0 0-1.657 1.343-3 3-3s3 1.343 3 3c0 0 0 0 0 0 0 1.657-1.343 3-3 3s-3-1.343-3-3zM1.75 16c0-1.243 1.007-2.25 2.25-2.25s2.25 1.007 2.25 2.25c0 1.243-1.007 2.25-2.25 2.25s-2.25-1.007-2.25-2.25z",fill:"#7353ba"})]})}):null,q=o=>{var l=o,{wrapperClass:e,Item:t,fetcher:s,empty:c}=l,a=k(l,["wrapperClass","Item","fetcher","empty"]);const u=d.exports.useRef(null),{data:i,isLoading:m}=s(u);return!m&&!i?r(A,v(C({},c),{fetchMoreEl:u})):n(P,{children:[r("div",{className:e,children:i==null?void 0:i.pages.map((f,Q)=>f==null?void 0:f.map((U,H)=>d.exports.createElement(t,v(C({item:U},a),{key:`${Q}_${H}`}))))}),r("div",{className:"fetch-more",ref:u}),r(Ue,{isLoading:m})]})},He=e=>{const t=d.exports.useRef(null),[s,c]=d.exports.useState(!1),a=d.exports.useRef(!0),o=()=>e.current?(t.current||(t.current=new IntersectionObserver(u=>{const i=u.some(m=>m.isIntersecting);if(!a.current){c(i);return}a.current=i})),t.current):null,l=()=>{var u;(u=o())==null||u.disconnect(),t.current=null};return d.exports.useEffect(()=>{var u;e.current&&((u=o())==null||u.observe(e.current))},[e==null?void 0:e.current]),d.exports.useEffect(()=>l,[]),{intersecting:s}},G=e=>{const{intersecting:t}=He(e),{data:s,fetchNextPage:c,hasNextPage:a,isLoading:o}=xe();return d.exports.useEffect(()=>{t&&a&&c()},[t,a]),d.exports.useEffect(()=>()=>{B.cancelQueries(h.products)},[]),{data:s,isLoading:o}},Je=()=>{const{modalComponent:e,showModal:t}=$();return n(P,{children:[r(q,{wrapperClass:"product-container",fetcher:G,Item:w,showModal:t,empty:{description:"\uBAA9\uB85D\uC774 \uBE44\uC5C8\uC2B5\uB2C8\uB2E4."}}),e]})},We=()=>n("section",{className:"page",children:[r(g,{title:"\uC0C1\uD488 \uBAA9\uB85D"}),r(Je,{})]}),Ve=({handleSubmit:e})=>{const t=Array.from({length:3}).map(()=>d.exports.createRef());return n("form",{onSubmit:c=>{c.preventDefault();const a=new FormData(c.target),o=Le(a.entries());e(o),t.forEach(l=>l.current.value="")},children:[r("label",{children:"\uCD94\uAC00"}),r("input",{ref:t[0],type:"text",name:"name",placeholder:"\uC0C1\uD488\uBA85"}),r("input",{ref:t[1],type:"text",name:"imageUrl",placeholder:"\uC774\uBBF8\uC9C0 url"}),r("input",{ref:t[2],type:"number",name:"price",placeholder:"\uAC00\uACA9"}),r("button",{type:"submit",children:"\uC804\uC1A1"})]})},Xe=({item:{id:e,price:t,name:s,imageUrl:c},deleteItem:a})=>n("div",{children:[r("img",{src:c,alt:s}),n("div",{className:"flex justify-between items-center p-5",children:[n("div",{className:"product-info",children:[r("span",{className:"product-info__name",children:s}),n("span",{className:"product-info__price",children:[N(t),"\uC6D0"]})]}),r("button",{className:"delete-button",onClick:()=>a(e),children:"\uC0AD\uC81C"})]})]}),Ye=()=>{const{mutate:e}=Pe(),{mutate:t}=Ee();return n("div",{className:"contents",children:[r(Ve,{handleSubmit:a=>e(a,{onSuccess:o=>{B.setQueryData(h.products,l=>[o,...l||[]])}})}),r(q,{wrapperClass:"product-container",fetcher:G,Item:Xe,deleteItem:a=>t(a,{onSuccess:()=>{B.setQueryData(h.products,o=>(o==null?void 0:o.filter(l=>l.id!==a))||[])}}),empty:{description:"\uBAA9\uB85D\uC774 \uBE44\uC5C8\uC2B5\uB2C8\uB2E4. \uC0C1\uD488\uC744 \uCD94\uAC00\uD574 \uC8FC\uC138\uC694."}})]})},Ze=()=>n("section",{className:"page admin-page",children:[r(g,{title:"\uC0C1\uD488 \uAD00\uB9AC"}),r(Ye,{})]}),Ke=({imageUrl:e,name:t,price:s,quantity:c})=>n("div",{className:"cart-container",children:[n("div",{className:"flex gap-15 mt-10",children:[r("input",{className:"checkbox",name:"checkbox",type:"checkbox"}),r("img",{className:"w-144 h-144",src:e,alt:t}),r("span",{className:"cart-name",children:t})]}),n("div",{className:"flex-col-center justify-end gap-15",children:[r("img",{className:"cart-trash-svg",src:"/assets/svgs/trash.svg",alt:"\uC0AD\uC81C"}),n("div",{className:"number-input-container",children:[r("input",{type:"number",className:"number-input",value:c,onChange:()=>{}}),n("div",{children:[r("button",{className:"number-input-button",children:"\u25B2"}),r("button",{className:"number-input-button",children:"\u25BC"})]})]}),n("span",{className:"cart-price",children:[N(s),"\uC6D0"]})]})]}),et=()=>{const{data:e}=E();if(!e)return r(A,{description:"\uC7A5\uBC14\uAD6C\uB2C8\uAC00 \uBE44\uC5C8\uC5B4\uC694.",backTo:"/",buttonText:"\uD648\uC73C\uB85C"});const t=M(e),s=N(L(e));return n("div",{className:"contents flex",children:[n("section",{className:"cart-left-section",children:[n("div",{className:"flex justify-between items-center",children:[n("div",{className:"checkbox-container",children:[r("input",{className:"checkbox",name:"checkbox",type:"checkbox"}),r("label",{className:"checkbox-label",htmlFor:"checkbox",children:"\uC120\uD0DD\uD574\uC81C"})]}),r("button",{className:"delete-button",children:"\uC0C1\uD488\uC0AD\uC81C"})]}),n("h3",{className:"cart-title",children:["\uB4E0\uB4E0\uBC30\uC1A1 \uC0C1\uD488(",t,"\uAC1C)"]}),e.map((c,a)=>n(d.exports.Fragment,{children:[r("hr",{className:`divide-line-${a===0?"gray":"thin"} mt-10`}),r(Ke,C({},c))]},a)),r("hr",{className:"divide-line-thin mt-10"})]}),n("section",{className:"cart-right-section",children:[r("div",{className:"cart-right-section__top",children:r("h3",{className:"cart-title",children:"\uACB0\uC81C\uC608\uC0C1\uAE08\uC561"})}),r("hr",{className:"divide-line-thin"}),n("div",{className:"cart-right-section__bottom",children:[n("div",{className:"flex justify-between p-20 mt-20",children:[r("span",{className:"highlight-text",children:"\uACB0\uC81C\uC608\uC0C1\uAE08\uC561"}),n("span",{className:"highlight-text",children:[s,"\uC6D0"]})]}),r("div",{className:"flex-center mt-30 mx-10",children:n("button",{className:"primary-button flex-center",children:["\uC8FC\uBB38\uD558\uAE30(",t,"\uAC1C)"]})})]})]})]})},tt=()=>n("section",{className:"page",children:[r(g,{title:"\uC7A5\uBC14\uAD6C\uB2C8"}),r(et,{})]}),z={"/":We,"/products/:id":Qe,"/cart":tt,"/order":Ie,"/ordered":$e,"/ordered/:id":Me,"/admin":Ze},rt=Object.keys(z),st=()=>{const{page:e,scroll:t}=ve(i=>i.lastScrollInfo),{pathname:s}=ne(),c=ce(),a=d.exports.useRef("/"),o=d.exports.useRef(0),l=_e(()=>{o.current=document.scrollingElement.scrollTop},100),u=async()=>{const i=a.current;await Fe(150),i===a.current&&e===a.current&&window.scrollTo(0,t)};return d.exports.useEffect(()=>{const i=a.current,m=rt.find(f=>ae(f,s));m!==i&&(c(fe({page:i,scroll:o.current})),a.current=m,u())},[s]),d.exports.useEffect(()=>(window.addEventListener("scroll",l),()=>{window.addEventListener("scroll",l)}),[]),n(P,{children:[r(be,{}),r(oe,{children:Object.entries(z).map(([i,m])=>r(ie,{path:i,element:r(m,{})},i))})]})};"scrollRestoration"in history&&(history.scrollRestoration="manual");le.render(r(ue.StrictMode,{children:r(de,{client:B,children:r(me,{store:ge,children:r(he,{children:r(st,{})})})})}),document.getElementById("root"));
